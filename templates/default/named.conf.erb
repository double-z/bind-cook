//
// named.conf
// generated by chef bind::root 
// 
//


include "<%=node[:bind][:key_file] %>"; 

options {
  listen-on port 53 { any; };
  listen-on-v6 port 53 { ::1; };
  directory       "/var/named";
  dump-file       "/var/named/data/cache_dump.db";
  statistics-file "/var/named/data/named_stats.txt";
  memstatistics-file "/var/named/data/named_mem_stats.txt";
  allow-query     { <%= Helpers::Dns.match_list(@allow_query) %> };
  recursion <%= @recursion %>;

  // Disable name checking for dynamic dns allowing names with _ in them
  check-names master ignore; 
  check-names slave  ignore; 
};


logging {
  channel default_debug {
    file "data/named.run";
    severity dynamic;
  };
  channel update_debug {
    file "/var/log/update-debug.log";
    severity  debug 3;
    print-category yes;
    print-severity yes;
    print-time     yes;
  };
  channel security_info    {
    file "/var/log/named-auth.info";
    severity  info;
    print-category yes;
    print-severity yes;
    print-time     yes;
  };
  category update { update_debug; };
  category security { security_info; };
};

zone "." IN {
  type hint;
  file "named.ca";
};

include "<%= node[:bind][:conf_dir] %>/named.rfc1912.zones";

<% @zones.each do |file| %>
include "/var/named/zones/<%= file %>";
<% end %>
